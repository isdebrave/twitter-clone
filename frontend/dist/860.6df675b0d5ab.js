"use strict";(self.webpackChunktwitter_clone=self.webpackChunktwitter_clone||[]).push([[860],{9127:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(7294);const a=function(e){var t=e.onClick,n=e.label,a=e.bold,o=e.icon,l=e.bgColor,s=e.textColor,c=e.hoverColor,i=e.large,u=e.disabled,m=e.fit;return r.createElement("button",{disabled:u,onClick:t,className:"\n        ".concat(i?"py-3":"py-2","\n        px-5 \n        flex \n        flex-row \n        justify-center\n        items-center \n        border-2\n        rounded-full \n        ").concat(m?"w-fit":"w-full","\n        transition\n        ").concat(l,"\n        ").concat(s,"\n        ").concat(c,"\n      ")},o&&r.createElement(o,{size:26,className:"mr-2"}),r.createElement("span",{className:"\n          ".concat(i?"text-lg":"text-base","\n          ").concat(a?"font-semibold":"font-normal","\n        ")},n))}},8035:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(7294),a=n(1649);const o=function(e){var t=e.title,n=e.length,o=e.onClick,l=e.backdropBlur;return r.createElement("div",{className:"\n        z-10 \n        sticky \n        top-0 \n        bg-white/70\n        flex \n        items-center \n        py-1 \n        px-2 \n        gap-6\n        ".concat(l&&"backdrop-blur-lg","\n      ")},r.createElement("div",{onClick:o,className:"p-2 rounded-full hover:bg-neutral-300/40 cursor-pointer"},r.createElement(a.UkU,{size:20})),r.createElement("div",{className:"flex flex-col"},r.createElement("span",{className:"font-bold text-lg"},t),void 0!==n&&r.createElement("span",{className:"font-bold text-xs text-gray-400"},n," posts")))}},9562:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(7294),a=n(1257),o=n(9250),l=n(5998),s=n(5539),c=n(4801);const i=function(e){var t=e.body,n=e.imagesCount,i=e.images,u=e.imagesHeight,m=void 0===u?"":u,d=(0,o.s0)(),f=(0,l.v9)((function(e){return e.post})),p=(0,c.Z)();return r.createElement(r.Fragment,null,r.createElement("p",{className:"text-gray-600 mb-3"},t),i.length>0&&r.createElement(s.Z,{onClick:function(e){if(e.stopPropagation(),f){var t="/".concat(f.user.id,"/status/").concat(f.id,"/photo");return d(t)}if(p.post)return t="/".concat(p.post.user.id,"/status/").concat(p.post.id,"/photo"),d(t)},imagesCount:n},i.map((function(e,t){return r.createElement("div",{key:e+t,className:"\n                w-full \n                ".concat(m.length>0?m:"h-full","\n                flex\n                ").concat(3===i.length&&0===t&&"row-span-2","\n              ")},r.createElement("img",{src:"".concat(a.default.defaults.baseURL,"/").concat(e),alt:"BodyImage",className:"w-full object-cover"}))}))))}},9488:(e,t,n)=>{n.d(t,{Z:()=>f});var r=n(7294),a=n(9250),o=n(9655),l=n(5998),s=n(155),c=n(1257),i=n(2898),u=n(9338),m=n(4801),d=n(3324);const f=function(e){var t=e.href,n=e.profileImage,f=e.username,p=e.userId,g=e.noEllipsis,v=(0,r.useState)(!1),h=v[0],b=v[1],E=(0,m.Z)(),y=(0,l.v9)((function(e){return e.me})),x=(0,l.v9)((function(e){return e.post})),w=(0,a.s0)(),I=(0,l.I0)();return(0,r.useEffect)((function(){var e=function(){return b(!1)};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[]),r.createElement("div",{className:"flex items-center gap-3"},r.createElement(o.rU,{to:t},r.createElement("div",{className:"\r w-[40px] \r h-[40px] \r flex\r rounded-full \r overflow-hidden \r hover:brightness-90 \r transition\r ",onClick:E.onClose},r.createElement("img",{src:(0,u.rd)(n),alt:"ProfileImage",className:"w-full object-cover"}))),r.createElement("div",{className:"flex flex-col flex-auto relative"},r.createElement(o.rU,{to:t,className:"w-fit",onClick:E.onClose},r.createElement("span",{className:"font-bold hover:underline"},f)),r.createElement("span",{className:"text-gray-500"},"@",p.slice(0,10)),y.id===p&&r.createElement(r.Fragment,null,!g&&r.createElement("div",{onClick:(0,i.E)((function(){return b(!0)})),className:"\r absolute \r -top-1 \r right-0\r p-2 \r rounded-full \r text-gray-600 \r hover:text-sky-500 \r hover:bg-sky-100\r cursor-pointer\r "},r.createElement(s.Ppk,{size:18})),h&&r.createElement("div",{onClick:function(e){return e.stopPropagation(),c.default.delete("/post",{data:{postId:x.id}}),I((0,d.XQ)({postId:x.id})),w("/home")},className:"\r absolute\r -top-1 \r right-0\r py-3 \r px-2\r rounded-xl \r bg-white \r text-red-500\r flex\r items-center\r font-semibold\r hover:bg-slate-100\r w-[300px]\r gap-2\r cursor-pointer\r ",style:{boxShadow:"0 0 5px rgba(0, 0, 0, 0.2)"}},r.createElement(s.L_o,{size:18}),r.createElement("span",null,"Delete")))))}},2605:(e,t,n)=>{n.d(t,{Z:()=>i}),n(6265);var r=n(7294),a=n(7536),o=n(5998),l=n(1257),s=n(9204),c=n(582);const i=function(e,t){void 0===t&&(t="POST");var n=(0,o.v9)((function(e){return e.me})),i=(0,r.useRef)(null),u=(0,r.useRef)(null),m=(0,r.useState)([]),d=m[0],f=m[1],p=(0,r.useState)([]),g=p[0],v=p[1],h=(0,r.useState)(""),b=h[0],E=h[1],y=(0,r.useState)(null),x=y[0],w=y[1],I=(0,r.useState)(""),k=I[0],N=I[1],C=(0,r.useState)(null),Z=C[0],P=C[1],S=(0,o.I0)(),A=(0,a.cI)(),O=A.register,D=A.watch,F=A.handleSubmit,H=A.setValue,M=A.clearErrors,j=A.formState.errors;(0,r.useEffect)((function(){var t=!0;for(var n in e)if(""!==e[n]){t=!1;break}if(!t)for(var n in e)H(n,e[n])}),[e,H]);var U=function(){for(var t in f([]),v([]),E(""),w(null),N(""),P(null),e)M(t),H(t,e[t])};return{imagesInputRef:i,coverImageInputRef:u,imagesPreview:d,setImagesPreview:f,imageFiles:g,setImageFiles:v,coverImagePreview:b,setCoverImagePreview:E,profileImagePreview:k,setProfileImagePreview:N,coverImage:x,setCoverImage:w,profileImage:Z,setProfileImage:P,register:O,errors:j,handleSubmit:F,keyDownHandler:function(e){var t=document.querySelector("textarea");t.style.height="auto";var n=e.target.scrollHeight;t.style.maxHeight="450px",t.style.height=n+"px"},onSubmit:function(e){return r=void 0,a=void 0,i=function(){var r,a,o,i,u,m,d,f,p,v,h,b,E,y,w,I,k;return function(e,t){var n,r,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(l=0)),l;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,r=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){l.label=s[1];break}if(6===s[0]&&l.label<a[1]){l.label=a[1],a=s;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(s);break}a[2]&&l.ops.pop(),l.trys.pop();continue}s=t.call(e,l)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(N){switch(N.label){case 0:if(r=e.data,a=e.fetchUrl,o=e.actionArray,i=e.shouldCommentAlert,u=void 0!==i&&i,m=e.onClose,d=e.post,f=e.onPageIndexPlus,p=e.errorMessage,0===r.body.length&&p)return[2,c.ZP.error(p)];for(v=new FormData,h=0,b=g;h<b.length;h++)E=b[h],v.append("bodyImages",E);d&&v.append("postId",d.id),x&&v.append("coverImage",x),Z&&v.append("profileImage",Z),v.append("data",JSON.stringify(r)),N.label=1;case 1:return N.trys.push([1,5,,6]),"POST"!==t?[3,3]:(o.forEach((function(e){return S(e())})),f&&f(),U(),m&&m(),[4,l.default.post(a,v)]);case 2:return y=N.sent(),o.forEach((function(e){return S(e(y.data))})),u&&d&&l.default.post("/notification",{body:"".concat(n.username," 님이 ").concat(d.id.slice(0,10)," 포스트에 댓글을 작성했습니다."),userId:d.user.id}),[3,4];case 3:l.default.patch(a,v),o.forEach((function(e){return S(e())})),U(),m&&m(),N.label=4;case 4:return[3,6];case 5:return(w=N.sent())instanceof s.d7&&(console.log(w),c.ZP.error(null===(I=w.response)||void 0===I?void 0:I.data),500===(null===(k=w.response)||void 0===k?void 0:k.status))?[2,alert(w.response.data)]:[3,6];case 6:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{s(i.next(e))}catch(e){t(e)}}function l(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,l)}s((i=i.apply(r,a||[])).next())}));var r,a,o,i},resetAll:U,watchAllFields:D()}}},6860:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var r=n(7294),a=n(5998),o=n(9250),l=n(7516),s=n(1257),c=n(8035),i=n(9488),u=n(9562),m=n(5710);const d=function(e){var t=e.createdAt,n=e.views;return r.createElement("p",{className:"text-gray-500"},t&&(0,m.Z)(new Date(t),"h:mm a · MMM d, yyyy")," ·"," ",r.createElement("span",{className:"font-bold text-black"},n)," View")};var f=n(2168),p=n(2605),g=n(4801),v=n(9338),h=n(5612),b=n(9127),E=n(1133),y=n(3324),x=n(5017);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}const I=function(){var e=(0,a.v9)((function(e){return e.me})),t=(0,a.v9)((function(e){return e.post})),n=(0,g.Z)(),o=(0,r.useMemo)((function(){return{body:""}}),[]),l=(0,p.Z)(o),s=l.handleSubmit,c=l.register,i=l.keyDownHandler,u=l.onSubmit,m=l.watchAllFields,d=r.createElement("div",{className:"flex gap-3 mb-4"},r.createElement("div",{className:"w-[40px] h-[40px] flex rounded-full overflow-hidden"},r.createElement("img",{src:(0,v.rd)(e.profileImage),alt:"ProfileImage",className:"w-full object-cover"})),r.createElement("textarea",w({placeholder:"Post your reply"},c("body"),{rows:2,className:"\r flex-auto\r resize-none\r outline-none\r text-xl\r placeholder-gray-500\r ",onKeyDown:i}))),f=[],I={id:Date.now(),body:m.body,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),userId:e.id,postId:t.id,user:{id:e.id,profileImage:e.profileImage,username:e.username}};f.push((function(e){return(0,E.sA)({options:I,data:e})})),f.push((function(e){return(0,y.oq)({options:I,data:e})})),f.push((function(e){return(0,x.CN)({options:I,data:e})}));var k=r.createElement("div",{className:"px-6"},r.createElement("form",{encType:"multipart/form-data",className:"flex justify-end items-center"},r.createElement(b.Z,{onClick:s((function(r){return u({data:r,fetchUrl:"/post/".concat(t.id,"/comment"),actionArray:f,shouldCommentAlert:t.user.id!==e.id,onClose:n.onClose,post:t,errorMessage:"댓글을 작성해주세요."})})),bgColor:h.Am,textColor:h.kt,hoverColor:h.Ay,label:"Reply",bold:!0,fit:!0})));return r.createElement(r.Fragment,null,d,k)};var k=n(3743),N=n(6355),C=n(8842),Z=n(582),P=n(8759);var S=n(3326),A=n(4276),O=n(7730),D=n(4909);const F=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],m=(0,o.UO)(),p=m.userId,v=m.postId,h=function(){var e=(0,o.UO)().postId,t=(0,o.s0)(),n=(0,C.Z)(e?"/post/".concat(e):null,P.Z,{onError:function(e){if(Z.ZP.error(e.response.data),500===e.response.status)return alert(e.response.data);t("/home")}});return{data:n.data,mutate:n.mutate}}().data,b=(0,S.Z)().likedHandler,y=(0,g.Z)(),x=(0,a.v9)((function(e){return e.me})),w=(0,a.v9)((function(e){return e.post})),F=(0,O.Z)().onPlus,H=(0,A.Z)({pathname:"/post/".concat(v,"/comment/all"),category:"COMMENT"}),M=H.data,j=H.isValidating,U=H.mutate,z=H.hasMoreData,R=(0,o.s0)(),T=(0,a.I0)();return(0,r.useEffect)((function(){h&&w.id!==h.id&&(T((0,E.YM)(h)),y.onPost(h))}),[w,h,T,y]),(0,r.useEffect)((function(){h&&(s.default.post("/post/views",{postId:h.id}),T((0,E.RI)()))}),[T,h]),(0,r.useEffect)((function(){z&&0===w.comments.length&&n(!0)}),[w.comments.length,z]),(0,r.useEffect)((function(){M&&z&&t&&U().then((function(e){T((0,E.tT)(e)),n(!1),F()})).catch((function(e){console.log(e)}))}),[t,U,M,T,z,F]),h&&h.user.id!==p?r.createElement(o.Fg,{to:"/".concat(h.user.id,"/status/").concat(v)}):r.createElement("div",{className:"relative h-full"},w.id!==v?r.createElement(N.Z,{size:80,absolute:!0,text:!0}):r.createElement(r.Fragment,null,r.createElement(c.Z,{title:"Post",onClick:function(){return R(-1)}}),r.createElement("div",{className:"p-3 px-4"},r.createElement("div",{className:"mb-3"},r.createElement(i.Z,{href:"/".concat(w.user.id),profileImage:w.user.profileImage,username:w.user.username,userId:w.user.id})),r.createElement("div",{className:"mb-3"},r.createElement(u.Z,{body:w.body,imagesCount:w.images.length,images:w.images})),r.createElement(d,{createdAt:w.createdAt,views:w.views}),r.createElement("hr",{className:"mt-3 mb-1"}),r.createElement("div",{className:"flex justify-around"},r.createElement(f.Z,{onClick:y.onOpen,icon:l.scr,length:w.comments.length,textHover:"group-hover:text-sky-500",bgHover:"group-hover:bg-sky-200/40",textColor:"text-gray-500"}),r.createElement(f.Z,{onClick:function(){return b(w)},icon:(0,D.o)(w.likedIds,x.id)?l.SEb:l.kTx,length:w.likedIds.length,textHover:"group-hover:text-rose-500",bgHover:"group-hover:bg-rose-200/40",textColor:(0,D.o)(w.likedIds,x.id)?"text-rose-500":"text-gray-500"})),r.createElement("hr",{className:"mt-1 mb-3"}),r.createElement(I,null),r.createElement("hr",{className:"my-3"}),z&&0===w.comments.length?r.createElement(N.Z,{size:80,text:!0}):r.createElement(k.Z,{lists:w.comments,isValidating:j,isEnter:t,setIsEnter:n,text:"댓글이 없습니다."}))))}}}]);