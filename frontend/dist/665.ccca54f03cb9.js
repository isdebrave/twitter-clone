"use strict";(self.webpackChunktwitter_clone=self.webpackChunktwitter_clone||[]).push([[665],{9127:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(7294);const a=function(e){var t=e.onClick,n=e.label,a=e.bold,o=e.icon,l=e.bgColor,s=e.textColor,c=e.hoverColor,i=e.large,u=e.disabled,f=e.fit;return r.createElement("button",{disabled:u,onClick:t,className:"\n        ".concat(i?"py-3":"py-2","\n        px-5 \n        flex \n        flex-row \n        justify-center\n        items-center \n        border-2\n        rounded-full \n        ").concat(f?"w-fit":"w-full","\n        transition\n        ").concat(l,"\n        ").concat(s,"\n        ").concat(c,"\n      ")},o&&r.createElement(o,{size:26,className:"mr-2"}),r.createElement("span",{className:"\n          ".concat(i?"text-lg":"text-base","\n          ").concat(a?"font-semibold":"font-normal","\n        ")},n))}},2605:(e,t,n)=>{n.d(t,{Z:()=>i}),n(6265);var r=n(7294),a=n(7536),o=n(5998),l=n(1257),s=n(9204),c=n(582);const i=function(e,t){void 0===t&&(t="POST");var n=(0,o.v9)((function(e){return e.me})),i=(0,r.useRef)(null),u=(0,r.useRef)(null),f=(0,r.useState)([]),m=f[0],d=f[1],p=(0,r.useState)([]),g=p[0],h=p[1],v=(0,r.useState)(""),b=v[0],y=v[1],w=(0,r.useState)(null),I=w[0],x=w[1],E=(0,r.useState)(""),P=E[0],S=E[1],k=(0,r.useState)(null),N=k[0],C=k[1],A=(0,o.I0)(),F=(0,a.cI)(),Z=F.register,O=F.watch,D=F.handleSubmit,j=F.setValue,M=F.clearErrors,R=F.formState.errors;(0,r.useEffect)((function(){var t=!0;for(var n in e)if(""!==e[n]){t=!1;break}if(!t)for(var n in e)j(n,e[n])}),[e,j]);var H=function(){for(var t in d([]),h([]),y(""),x(null),S(""),C(null),e)M(t),j(t,e[t])};return{imagesInputRef:i,coverImageInputRef:u,imagesPreview:m,setImagesPreview:d,imageFiles:g,setImageFiles:h,coverImagePreview:b,setCoverImagePreview:y,profileImagePreview:P,setProfileImagePreview:S,coverImage:I,setCoverImage:x,profileImage:N,setProfileImage:C,register:Z,errors:R,handleSubmit:D,keyDownHandler:function(e){var t=document.querySelector("textarea");t.style.height="auto";var n=e.target.scrollHeight;t.style.maxHeight="450px",t.style.height=n+"px"},onSubmit:function(e){return r=void 0,a=void 0,i=function(){var r,a,o,i,u,f,m,d,p,h,v,b,y,w,x,E,P;return function(e,t){var n,r,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(l=0)),l;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,r=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){l.label=s[1];break}if(6===s[0]&&l.label<a[1]){l.label=a[1],a=s;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(s);break}a[2]&&l.ops.pop(),l.trys.pop();continue}s=t.call(e,l)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(S){switch(S.label){case 0:if(r=e.data,a=e.fetchUrl,o=e.actionArray,i=e.shouldCommentAlert,u=void 0!==i&&i,f=e.onClose,m=e.post,d=e.onPageIndexPlus,p=e.errorMessage,0===r.body.length&&p)return[2,c.ZP.error(p)];for(h=new FormData,v=0,b=g;v<b.length;v++)y=b[v],h.append("bodyImages",y);m&&h.append("postId",m.id),I&&h.append("coverImage",I),N&&h.append("profileImage",N),h.append("data",JSON.stringify(r)),S.label=1;case 1:return S.trys.push([1,5,,6]),"POST"!==t?[3,3]:(o.forEach((function(e){return A(e())})),d&&d(),H(),f&&f(),[4,l.default.post(a,h)]);case 2:return w=S.sent(),o.forEach((function(e){return A(e(w.data))})),u&&m&&l.default.post("/notification",{body:"".concat(n.username," 님이 ").concat(m.id.slice(0,10)," 포스트에 댓글을 작성했습니다."),userId:m.user.id}),[3,4];case 3:l.default.patch(a,h),o.forEach((function(e){return A(e())})),H(),f&&f(),S.label=4;case 4:return[3,6];case 5:return(x=S.sent())instanceof s.d7&&(console.log(x),c.ZP.error(null===(E=x.response)||void 0===E?void 0:E.data),500===(null===(P=x.response)||void 0===P?void 0:P.status))?[2,alert(x.response.data)]:[3,6];case 6:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{s(i.next(e))}catch(e){t(e)}}function l(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,l)}s((i=i.apply(r,a||[])).next())}));var r,a,o,i},resetAll:H,watchAllFields:O()}}},8665:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(7294),a=n(5998),o=n(5434),l=n(3324),s=n(5017),c=n(9338),i=n(5612),u=n(9127),f=n(2605),m=n(4454);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}var p=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};const g=function(){var e=(0,a.v9)((function(e){return e.me})),t=(0,m.Z)(),n=(0,r.useMemo)((function(){return{body:""}}),[]),g=(0,f.Z)(n),h=g.handleSubmit,v=g.imageFiles,b=g.imagesPreview,y=g.register,w=g.setImageFiles,I=g.setImagesPreview,x=g.keyDownHandler,E=g.imagesInputRef,P=g.onSubmit,S=g.watchAllFields,k=r.createElement("div",{className:"px-6"},r.createElement("div",{className:"flex gap-3 mb-4"},r.createElement("div",{className:"w-[40px] h-[40px] flex rounded-full overflow-hidden"},r.createElement("img",{src:(0,c.rd)(e.profileImage),alt:"ProfileImage",className:"w-full object-cover"})),r.createElement("textarea",d({placeholder:"What is happening?!"},y("body"),{rows:2,className:"\r flex-auto \r resize-none \r outline-none \r text-xl \r placeholder-gray-500\r ",onKeyDown:x})))),N=[],C={id:Date.now(),body:S.body,images:b,views:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),userId:e.id,likedIds:[],user:{id:e.id,profileImage:e.profileImage,username:e.username},comments:[]};N.push((function(e){return(0,l.Kv)({options:C,data:e})})),N.push((function(e){return(0,s.vR)({options:C,data:e})}));var A=r.createElement("div",{className:"px-6"},r.createElement("form",{encType:"multipart/form-data",className:"flex justify-between items-center"},r.createElement("label",{htmlFor:"bodyImages",className:"block p-2 rounded-full hover:bg-sky-100 cursor-pointer"},r.createElement(o.mxp,{className:"text-sky-500",size:24})),r.createElement("input",{ref:E,type:"file",id:"bodyImages",name:"bodyImages",hidden:!0,multiple:!0,accept:"image/*",onChange:function(e){return(0,c.od)(e,(function(e){return w((function(t){return p(p([],t,!0),[e],!1)}))}),(function(e){return I((function(t){return p(p([],t,!0),[e],!1)}))}),v)}}),r.createElement(u.Z,{onClick:h((function(e){return P({data:e,fetchUrl:"/post",actionArray:N,onPageIndexPlus:t.onPlus,errorMessage:"포스트를 작성해주세요."})})),bgColor:i.Am,textColor:i.kt,hoverColor:i.Ay,label:"Post",bold:!0,fit:!0})),b.length>0&&r.createElement(r.Fragment,null,r.createElement("hr",{className:"my-3"}),r.createElement("div",{className:"flex gap-3"},b.map((function(e,t){return r.createElement("div",{key:e+t,className:"w-[50px] h-[50px] flex cursor-pointer",onClick:function(e){return(0,c.Nf)(e,E,(function(e){return w(e)}),(function(e){return I(e)}),v,b)}},r.createElement("img",{"data-idx":t,src:e,alt:"BodyImages",className:"w-full object-cover"}))})))));return r.createElement(r.Fragment,null,k,A)};var h=n(3743),v=n(6355),b=n(4276);const y=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],o=(0,a.v9)((function(e){return e.posts})),s=(0,m.Z)().onPlus,c=(0,b.Z)({pathname:"/post/all",category:"HOME"}),i=c.data,u=c.isValidating,f=c.mutate,d=c.hasMoreData,p=(0,a.I0)();return(0,r.useEffect)((function(){d&&0===o.length&&n(!0)}),[o.length,d]),(0,r.useEffect)((function(){i&&d&&t&&f().then((function(e){p((0,l.bM)(e)),n(!1),s()})).catch((function(e){console.log(e)}))}),[t,f,i,p,d,s]),r.createElement(r.Fragment,null,r.createElement("div",{className:"hidden sm:block mt-4"},r.createElement(g,null),r.createElement("hr",{className:"my-3"})),r.createElement("hr",{className:"sm:hidden"}),d&&0===o.length?r.createElement(v.Z,{size:80,text:!0}):r.createElement(h.Z,{lists:o,isValidating:u,isEnter:t,setIsEnter:n,text:"포스팅이 없습니다."}))}}}]);