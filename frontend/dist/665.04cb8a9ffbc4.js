"use strict";(self.webpackChunktwitter_clone=self.webpackChunktwitter_clone||[]).push([[665],{9127:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(7294);const a=function(e){var t=e.onClick,n=e.label,a=e.bold,o=e.icon,l=e.bgColor,i=e.textColor,s=e.hoverColor,c=e.large,u=e.disabled,f=e.fit;return r.createElement("button",{disabled:u,onClick:t,className:"\n        ".concat(c?"py-3":"py-2","\n        px-5 \n        flex \n        flex-row \n        justify-center\n        items-center \n        border-2\n        rounded-full \n        ").concat(f?"w-fit":"w-full","\n        transition\n        ").concat(l,"\n        ").concat(i,"\n        ").concat(s,"\n      ")},o&&r.createElement(o,{size:26,className:"mr-2"}),r.createElement("span",{className:"\n          ".concat(c?"text-lg":"text-base","\n          ").concat(a?"font-semibold":"font-normal","\n        ")},n))}},2605:(e,t,n)=>{n.d(t,{Z:()=>c}),n(6265);var r=n(7294),a=n(7536),o=n(5998),l=n(1257),i=n(9204),s=n(582);const c=function(e,t){void 0===t&&(t="POST");var n=(0,o.v9)((function(e){return e.me})),c=(0,r.useRef)(null),u=(0,r.useRef)(null),f=(0,r.useState)([]),m=f[0],d=f[1],p=(0,r.useState)([]),g=p[0],h=p[1],v=(0,r.useState)(""),b=v[0],y=v[1],w=(0,r.useState)(null),E=w[0],I=w[1],x=(0,r.useState)(""),S=x[0],k=x[1],N=(0,r.useState)(null),C=N[0],P=N[1],A=(0,o.I0)(),F=(0,a.cI)(),D=F.register,O=F.watch,Z=F.handleSubmit,j=F.setValue,R=F.clearErrors,M=F.formState.errors;(0,r.useEffect)((function(){var t=!0;for(var n in e)if(""!==e[n]){t=!1;break}if(!t)for(var n in e)j(n,e[n])}),[e,j]);var z=function(){for(var t in d([]),h([]),y(""),I(null),k(""),P(null),e)R(t),j(t,e[t])};return{imagesInputRef:c,coverImageInputRef:u,imagesPreview:m,setImagesPreview:d,imageFiles:g,setImageFiles:h,coverImagePreview:b,setCoverImagePreview:y,profileImagePreview:S,setProfileImagePreview:k,coverImage:E,setCoverImage:I,profileImage:C,setProfileImage:P,register:D,errors:M,handleSubmit:Z,keyDownHandler:function(e){var t=document.querySelector("textarea");t.style.height="auto";var n=e.target.scrollHeight;t.style.maxHeight="450px",t.style.height=n+"px"},onSubmit:function(e){return r=void 0,a=void 0,c=function(){var r,a,o,c,u,f,m,d,p,h,v,b,y,w,I,x;return function(e,t){var n,r,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(S){switch(S.label){case 0:if(r=e.data,a=e.fetchUrl,o=e.actionArray,c=e.shouldCommentAlert,u=void 0!==c&&c,f=e.onClose,m=e.post,d=e.errorMessage,"body"in r&&0===r.body.length&&d)return[2,s.ZP.error(d)];for(p=new FormData,h=0,v=g;h<v.length;h++)b=v[h],p.append("bodyImages",b);m&&p.append("postId",m.id),E&&p.append("coverImage",E),C&&p.append("profileImage",C),p.append("data",JSON.stringify(r)),S.label=1;case 1:return S.trys.push([1,5,,6]),"POST"!==t?[3,3]:(o.forEach((function(e){return A(e())})),z(),f&&f(),[4,l.default.post(a,p)]);case 2:return y=S.sent(),o.forEach((function(e){return A(e(y.data))})),u&&m&&l.default.post("/notification",{body:"".concat(n.username," 님이 ").concat(m.id.slice(0,10)," 포스트에 댓글을 작성했습니다."),userId:m.user.id}),[3,4];case 3:l.default.patch(a,p),o.forEach((function(e){return A(e())})),z(),f&&f(),S.label=4;case 4:return[3,6];case 5:return(w=S.sent())instanceof i.d7&&(console.log(w),s.ZP.error(null===(I=w.response)||void 0===I?void 0:I.data),500===(null===(x=w.response)||void 0===x?void 0:x.status))?[2,alert(w.response.data)]:[3,6];case 6:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function l(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,l)}i((c=c.apply(r,a||[])).next())}));var r,a,o,c},resetAll:z,watchAllFields:O()}}},8665:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var r=n(7294),a=n(5998),o=n(5434),l=n(3324),i=n(5017),s=n(9338),c=n(5612),u=n(9127),f=n(2605);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}var d=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};const p=function(){var e=(0,a.v9)((function(e){return e.me})),t=(0,r.useMemo)((function(){return{body:""}}),[]),n=(0,f.Z)(t),p=n.handleSubmit,g=n.imageFiles,h=n.imagesPreview,v=n.register,b=n.setImageFiles,y=n.setImagesPreview,w=n.keyDownHandler,E=n.imagesInputRef,I=n.onSubmit,x=n.watchAllFields,S=r.createElement("div",{className:"px-6"},r.createElement("div",{className:"flex gap-3 mb-4"},r.createElement("div",{className:"w-[40px] h-[40px] flex rounded-full overflow-hidden"},r.createElement("img",{src:(0,s.rd)(e.profileImage),alt:"ProfileImage",className:"w-full object-cover"})),r.createElement("textarea",m({placeholder:"What is happening?!"},v("body"),{rows:2,className:"\r flex-auto \r resize-none \r outline-none \r text-xl \r placeholder-gray-500\r ",onKeyDown:w})))),k=[],N={id:Date.now(),body:x.body,images:h,views:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),userId:e.id,likedIds:[],user:{id:e.id,profileImage:e.profileImage,username:e.username},comments:[],totalCommentsCount:0};k.push((function(e){return(0,l.Kv)({options:N,data:e})})),k.push((function(e){return(0,i.vR)({options:N,data:e})}));var C=r.createElement("div",{className:"px-6"},r.createElement("form",{encType:"multipart/form-data",className:"flex justify-between items-center"},r.createElement("label",{htmlFor:"bodyImages",className:"block p-2 rounded-full hover:bg-sky-100 cursor-pointer"},r.createElement(o.mxp,{className:"text-sky-500",size:24})),r.createElement("input",{ref:E,type:"file",id:"bodyImages",name:"bodyImages",hidden:!0,multiple:!0,accept:"image/*",onChange:function(e){return(0,s.od)(e,(function(e){return b((function(t){return d(d([],t,!0),[e],!1)}))}),(function(e){return y((function(t){return d(d([],t,!0),[e],!1)}))}),g)}}),r.createElement(u.Z,{onClick:p((function(e){return I({data:e,fetchUrl:"/post",actionArray:k,errorMessage:"포스트를 작성해주세요."})})),bgColor:c.Am,textColor:c.kt,hoverColor:c.Ay,label:"Post",bold:!0,fit:!0})),h.length>0&&r.createElement(r.Fragment,null,r.createElement("hr",{className:"my-3"}),r.createElement("div",{className:"flex gap-3"},h.map((function(e,t){return r.createElement("div",{key:e+t,className:"w-[50px] h-[50px] flex cursor-pointer",onClick:function(e){return(0,s.Nf)(e,E,(function(e){return b(e)}),(function(e){return y(e)}),g,h)}},r.createElement("img",{"data-idx":t,src:e,alt:"BodyImages",className:"w-full object-cover"}))})))));return r.createElement(r.Fragment,null,S,C)};var g=n(3743),h=n(6355),v=n(4276);const b=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],o=(0,a.v9)((function(e){return e.posts})),i=(0,v.Z)({pathname:"/post/all",savedData:o,isSameUrl:!0}),s=i.data,c=i.isValidating,u=i.mutate,f=i.hasMoreData,m=(0,a.I0)();return(0,r.useEffect)((function(){f&&0===o.length&&n(!0)}),[o.length,f]),(0,r.useEffect)((function(){s&&f&&t&&u().then((function(e){m((0,l.bM)(e)),n(!1)})).catch((function(e){console.log(e)}))}),[t,u,s,m,f]),r.createElement(r.Fragment,null,r.createElement("div",{className:"hidden sm:block mt-4"},r.createElement(p,null),r.createElement("hr",{className:"my-3"})),r.createElement("hr",{className:"sm:hidden"}),f&&0===o.length?r.createElement(h.Z,{size:80,text:!0}):r.createElement(g.Z,{lists:o,isValidating:c,isEnter:t,setIsEnter:n,text:"포스팅이 없습니다."}))}}}]);