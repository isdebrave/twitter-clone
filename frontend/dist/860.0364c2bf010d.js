"use strict";(self.webpackChunktwitter_clone=self.webpackChunktwitter_clone||[]).push([[860],{9127:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(7294);const a=function(e){var t=e.onClick,r=e.label,a=e.bold,o=e.icon,l=e.bgColor,s=e.textColor,c=e.hoverColor,i=e.large,u=e.disabled,m=e.fit;return n.createElement("button",{disabled:u,onClick:t,className:"\n        ".concat(i?"py-3":"py-2","\n        px-5 \n        flex \n        flex-row \n        justify-center\n        items-center \n        border-2\n        rounded-full \n        ").concat(m?"w-fit":"w-full","\n        transition\n        ").concat(l,"\n        ").concat(s,"\n        ").concat(c,"\n      ")},o&&n.createElement(o,{size:26,className:"mr-2"}),n.createElement("span",{className:"\n          ".concat(i?"text-lg":"text-base","\n          ").concat(a?"font-semibold":"font-normal","\n        ")},r))}},8035:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(7294),a=r(1649);const o=function(e){var t=e.title,r=e.length,o=e.onClick,l=e.backdropBlur;return n.createElement("div",{className:"\n        z-10 \n        sticky \n        top-0 \n        bg-white/70\n        flex \n        items-center \n        py-1 \n        px-2 \n        gap-6\n        ".concat(l&&"backdrop-blur-lg","\n      ")},n.createElement("div",{onClick:o,className:"p-2 rounded-full hover:bg-neutral-300/40 cursor-pointer"},n.createElement(a.UkU,{size:20})),n.createElement("div",{className:"flex flex-col"},n.createElement("span",{className:"font-bold text-lg"},t),void 0!==r&&n.createElement("span",{className:"font-bold text-xs text-gray-400"},r," posts")))}},9562:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(7294),a=r(9250),o=r(5998),l=r(5539),s=r(4801),c=r(9338);const i=function(e){var t=e.body,r=e.imagesCount,i=e.images,u=e.imagesHeight,m=void 0===u?"":u,d=(0,a.s0)(),f=(0,o.v9)((function(e){return e.post})),p=(0,s.Z)();return n.createElement(n.Fragment,null,n.createElement("p",{className:"text-gray-600 mb-3"},t),i.length>0&&n.createElement(l.Z,{onClick:function(e){if(e.stopPropagation(),f){var t="/".concat(f.user.id,"/status/").concat(f.id,"/photo");return d(t)}if(p.post)return t="/".concat(p.post.user.id,"/status/").concat(p.post.id,"/photo"),d(t)},imagesCount:r},i.map((function(e,t){return n.createElement("div",{key:e+t,className:"\n                w-full \n                ".concat(m.length>0?m:"h-full","\n                flex\n                ").concat(3===i.length&&0===t&&"row-span-2","\n              ")},n.createElement("img",{src:(0,c.rd)(e),alt:"BodyImage",className:"w-full object-cover"}))}))))}},9488:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(7294),a=r(9250),o=r(9655),l=r(5998),s=r(155),c=r(1257),i=r(2898),u=r(9338),m=r(4801),d=r(3324);const f=function(e){var t=e.href,r=e.profileImage,f=e.username,p=e.userId,v=e.noEllipsis,g=(0,n.useState)(!1),h=g[0],b=g[1],E=(0,m.Z)(),y=(0,l.v9)((function(e){return e.me})),x=(0,l.v9)((function(e){return e.post})),w=(0,a.s0)(),I=(0,l.I0)();return(0,n.useEffect)((function(){var e=function(){return b(!1)};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[]),n.createElement("div",{className:"flex items-center gap-3"},n.createElement(o.rU,{to:t},n.createElement("div",{className:"\r w-[40px] \r h-[40px] \r flex\r rounded-full \r overflow-hidden \r hover:brightness-90 \r transition\r ",onClick:E.onClose},n.createElement("img",{src:(0,u.rd)(r),alt:"ProfileImage",className:"w-full object-cover"}))),n.createElement("div",{className:"flex flex-col flex-auto relative"},n.createElement(o.rU,{to:t,className:"w-fit",onClick:E.onClose},n.createElement("span",{className:"font-bold hover:underline"},f)),n.createElement("span",{className:"text-gray-500"},"@",p.slice(0,10)),y.id===p&&n.createElement(n.Fragment,null,!v&&n.createElement("div",{onClick:(0,i.E)((function(){return b(!0)})),className:"\r absolute \r -top-1 \r right-0\r p-2 \r rounded-full \r text-gray-600 \r hover:text-sky-500 \r hover:bg-sky-100\r cursor-pointer\r "},n.createElement(s.Ppk,{size:18})),h&&n.createElement("div",{onClick:function(e){return e.stopPropagation(),c.default.delete("/post",{data:{postId:x.id}}),I((0,d.XQ)({postId:x.id})),w("/home")},className:"\r absolute\r -top-1 \r right-0\r py-3 \r px-2\r rounded-xl \r bg-white \r text-red-500\r flex\r items-center\r font-semibold\r hover:bg-slate-100\r w-[300px]\r gap-2\r cursor-pointer\r ",style:{boxShadow:"0 0 5px rgba(0, 0, 0, 0.2)"}},n.createElement(s.L_o,{size:18}),n.createElement("span",null,"Delete")))))}},2605:(e,t,r)=>{r.d(t,{Z:()=>i}),r(6265);var n=r(7294),a=r(7536),o=r(5998),l=r(1257),s=r(9204),c=r(582);const i=function(e,t){void 0===t&&(t="POST");var r=(0,o.v9)((function(e){return e.me})),i=(0,n.useRef)(null),u=(0,n.useRef)(null),m=(0,n.useState)([]),d=m[0],f=m[1],p=(0,n.useState)([]),v=p[0],g=p[1],h=(0,n.useState)(""),b=h[0],E=h[1],y=(0,n.useState)(null),x=y[0],w=y[1],I=(0,n.useState)(""),k=I[0],C=I[1],N=(0,n.useState)(null),Z=N[0],S=N[1],P=(0,o.I0)(),A=(0,a.cI)(),O=A.register,D=A.watch,F=A.handleSubmit,H=A.setValue,j=A.clearErrors,U=A.formState.errors;(0,n.useEffect)((function(){var t=!0;for(var r in e)if(""!==e[r]){t=!1;break}if(!t)for(var r in e)H(r,e[r])}),[e,H]);var z=function(){for(var t in f([]),g([]),E(""),w(null),C(""),S(null),e)j(t),H(t,e[t])};return{imagesInputRef:i,coverImageInputRef:u,imagesPreview:d,setImagesPreview:f,imageFiles:v,setImageFiles:g,coverImagePreview:b,setCoverImagePreview:E,profileImagePreview:k,setProfileImagePreview:C,coverImage:x,setCoverImage:w,profileImage:Z,setProfileImage:S,register:O,errors:U,handleSubmit:F,keyDownHandler:function(e){var t=document.querySelector("textarea");t.style.height="auto";var r=e.target.scrollHeight;t.style.maxHeight="450px",t.style.height=r+"px"},onSubmit:function(e){return n=void 0,a=void 0,i=function(){var n,a,o,i,u,m,d,f,p,g,h,b,E,y,w,I;return function(e,t){var r,n,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(l=0)),l;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,n=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){l.label=s[1];break}if(6===s[0]&&l.label<a[1]){l.label=a[1],a=s;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(s);break}a[2]&&l.ops.pop(),l.trys.pop();continue}s=t.call(e,l)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(k){switch(k.label){case 0:if(n=e.data,a=e.fetchUrl,o=e.actionArray,i=e.shouldCommentAlert,u=void 0!==i&&i,m=e.onClose,d=e.post,f=e.errorMessage,"body"in n&&0===n.body.length&&f)return[2,c.ZP.error(f)];for(p=new FormData,g=0,h=v;g<h.length;g++)b=h[g],p.append("bodyImages",b);d&&p.append("postId",d.id),x&&p.append("coverImage",x),Z&&p.append("profileImage",Z),p.append("data",JSON.stringify(n)),k.label=1;case 1:return k.trys.push([1,5,,6]),"POST"!==t?[3,3]:(o.forEach((function(e){return P(e())})),z(),m&&m(),[4,l.default.post(a,p)]);case 2:return E=k.sent(),o.forEach((function(e){return P(e(E.data))})),u&&d&&l.default.post("/notification",{body:"".concat(r.username," 님이 ").concat(d.id.slice(0,10)," 포스트에 댓글을 작성했습니다."),userId:d.user.id}),[3,4];case 3:l.default.patch(a,p),o.forEach((function(e){return P(e())})),z(),m&&m(),k.label=4;case 4:return[3,6];case 5:return(y=k.sent())instanceof s.d7&&(console.log(y),c.ZP.error(null===(w=y.response)||void 0===w?void 0:w.data),500===(null===(I=y.response)||void 0===I?void 0:I.status))?[2,alert(y.response.data)]:[3,6];case 6:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(e){t(e)}}function l(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,l)}s((i=i.apply(n,a||[])).next())}));var n,a,o,i},resetAll:z,watchAllFields:D()}}},6860:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var n=r(7294),a=r(5998),o=r(9250),l=r(7516),s=r(1257),c=r(8035),i=r(9488),u=r(9562),m=r(5710);const d=function(e){var t=e.createdAt,r=e.views;return n.createElement("p",{className:"text-gray-500"},t&&(0,m.Z)(new Date(t),"h:mm a · MMM d, yyyy")," ·"," ",n.createElement("span",{className:"font-bold text-black"},r)," View")};var f=r(2168),p=r(2605),v=r(4801),g=r(9338),h=r(5612),b=r(9127),E=r(1133),y=r(3324),x=r(5017);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}const I=function(){var e=(0,a.v9)((function(e){return e.me})),t=(0,a.v9)((function(e){return e.post})),r=(0,v.Z)(),o=(0,n.useMemo)((function(){return{body:""}}),[]),l=(0,p.Z)(o),s=l.handleSubmit,c=l.register,i=l.keyDownHandler,u=l.onSubmit,m=l.watchAllFields,d=n.createElement("div",{className:"flex gap-3 mb-4"},n.createElement("div",{className:"w-[40px] h-[40px] flex rounded-full overflow-hidden"},n.createElement("img",{src:(0,g.rd)(e.profileImage),alt:"ProfileImage",className:"w-full object-cover"})),n.createElement("textarea",w({placeholder:"Post your reply"},c("body"),{rows:2,className:"\r flex-auto\r resize-none\r outline-none\r text-xl\r placeholder-gray-500\r ",onKeyDown:i}))),f=[],I={id:Date.now(),body:m.body,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),userId:e.id,postId:t.id,user:{id:e.id,profileImage:e.profileImage,username:e.username}};f.push((function(e){return(0,E.sA)({options:I,data:e})})),f.push((function(e){return(0,y.oq)({options:I,data:e})})),f.push((function(e){return(0,x.CN)({options:I,data:e})}));var k=n.createElement("div",{className:"px-6"},n.createElement("form",{encType:"multipart/form-data",className:"flex justify-end items-center"},n.createElement(b.Z,{onClick:s((function(n){return u({data:n,fetchUrl:"/post/".concat(t.id,"/comment"),actionArray:f,shouldCommentAlert:t.user.id!==e.id,onClose:r.onClose,post:t,errorMessage:"댓글을 작성해주세요."})})),bgColor:h.Am,textColor:h.kt,hoverColor:h.Ay,label:"Reply",bold:!0,fit:!0})));return n.createElement(n.Fragment,null,d,k)};var k=r(3743),C=r(6355),N=r(8842),Z=r(582),S=r(8759);var P=r(3326),A=r(4276),O=r(4909);const D=function(){var e=(0,n.useState)(!1),t=e[0],r=e[1],m=(0,o.UO)(),p=m.userId,g=m.postId,h=(0,a.v9)((function(e){return e.me})),b=(0,a.v9)((function(e){return e.post})),y=(0,o.s0)(),x=(0,a.I0)(),w=(0,P.Z)().likedHandler,D=(0,v.Z)(),F=function(){var e=(0,o.UO)().postId,t=(0,o.s0)(),r=(0,N.Z)(e?"/post/".concat(e):null,S.Z,{onError:function(e){if(Z.ZP.error(e.response.data),500===e.response.status)return alert(e.response.data);t("/home")}});return{data:r.data,mutate:r.mutate}}().data,H=(0,A.Z)({pathname:"/post/".concat(g,"/comment/all"),savedData:b.comments,isSameUrl:b.id===g}),j=H.data,U=H.isValidating,z=H.mutate,M=H.hasMoreData;return(0,n.useEffect)((function(){F&&b.id!==F.id&&(x((0,E.YM)(F)),D.onPost(F))}),[b,F,x,D]),(0,n.useEffect)((function(){F&&(s.default.post("/post/views",{postId:F.id}),x((0,E.RI)()))}),[x,F]),(0,n.useEffect)((function(){M&&0===b.comments.length&&r(!0)}),[b.comments.length,M]),(0,n.useEffect)((function(){j&&M&&t&&z().then((function(e){x((0,E.tT)(e)),r(!1)})).catch((function(e){console.log(e)}))}),[t,z,j,x,M]),F&&F.user.id!==p?n.createElement(o.Fg,{to:"/".concat(F.user.id,"/status/").concat(g)}):n.createElement("div",{className:"relative h-full"},b.id!==g?n.createElement(C.Z,{size:80,absolute:!0,text:!0}):n.createElement(n.Fragment,null,n.createElement(c.Z,{title:"Post",onClick:function(){return y(-1)}}),n.createElement("div",{className:"p-3 px-4"},n.createElement("div",{className:"mb-3"},n.createElement(i.Z,{href:"/".concat(b.user.id),profileImage:b.user.profileImage,username:b.user.username,userId:b.user.id})),n.createElement("div",{className:"mb-3"},n.createElement(u.Z,{body:b.body,imagesCount:b.images.length,images:b.images})),n.createElement(d,{createdAt:b.createdAt,views:b.views}),n.createElement("hr",{className:"mt-3 mb-1"}),n.createElement("div",{className:"flex justify-around"},n.createElement(f.Z,{onClick:D.onOpen,icon:l.scr,length:b.totalCommentsCount,textHover:"group-hover:text-sky-500",bgHover:"group-hover:bg-sky-200/40",textColor:"text-gray-500"}),n.createElement(f.Z,{onClick:function(){return w(b)},icon:(0,O.o)(b.likedIds,h.id)?l.SEb:l.kTx,length:b.likedIds.length,textHover:"group-hover:text-rose-500",bgHover:"group-hover:bg-rose-200/40",textColor:(0,O.o)(b.likedIds,h.id)?"text-rose-500":"text-gray-500"})),n.createElement("hr",{className:"mt-1 mb-3"}),n.createElement(I,null),n.createElement("hr",{className:"my-3"}),M&&0===b.comments.length?n.createElement(C.Z,{size:80,text:!0}):n.createElement(k.Z,{lists:b.comments,isValidating:U,isEnter:t,setIsEnter:r,text:"댓글이 없습니다."}))))}}}]);